---
title: 发送以太网帧
description: 发送以太网帧
keywords:
- 以太网 WDK 网络
- 帧 WDK 网络
- 以太网帧的 TCP/IP 传输-WDK 网络
- 发送以太网帧
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 7af5b5c51fe35c00510cdd0f576f819538b0ea38
ms.sourcegitcommit: a9fb2c30adf09ee24de8e68ac1bc6326ef3616b8
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/06/2021
ms.locfileid: "102249131"
---
# <a name="sending-ethernet-frames"></a>发送以太网帧





Windows TCP/IP 传输支持一组用于发送以太网帧的要求。 任何驱动程序 (例如，发出发送请求或修改过量驱动程序的发送请求的 MUX 中间驱动程序或筛选器驱动程序) 都必须支持 TCP/IP 传输实现的要求。

**注意**  如果驱动程序堆栈中的任何驱动程序未遵循这些要求，则基础微型端口驱动程序、MUX 中间驱动程序和筛选器驱动程序的行为可能无法预测。

 

对于以太网发送请求，驱动程序必须支持以下要求：

-   如果驱动程序发出发送请求，则驱动程序应为以太网帧分配 [**网络 \_ 缓冲区 \_ 列表**](/windows-hardware/drivers/ddi/nbl/ns-nbl-net_buffer_list) 结构。 每个网络缓冲区列表结构中的 **NetBufferListInfo** 成员 \_ \_ 必须包含用于特定用途的带外 (OOB) 数据。 OOB 数据适用于与网络缓冲区列表结构关联的所有 [**网络 \_ 缓冲区**](/windows-hardware/drivers/ddi/nbl/ns-nbl-net_buffer) 结构 \_ \_ 。

-   如果驱动程序发出发送请求，则驱动程序应为以太网帧分配一个或多个网络 \_ 缓冲区结构，并将这些结构链接到网络 \_ 缓冲区 \_ 列表结构。 每个 \_ 链接到网络缓冲区列表结构的网络缓冲区结构都 \_ \_ 描述了单个以太网帧。 驱动程序可以 \_ 在发送请求中链接多个网络缓冲区 \_ 列表结构。 

-   \_与网络缓冲区列表结构关联的所有网络缓冲区结构都 \_ \_ 必须具有相同的以太网帧类型和 IP 协议版本 (IPv4 或 IPv6) 。

-   \_与网络缓冲区列表结构关联的所有网络缓冲区结构都 \_ \_ 必须具有相同的源和目标 MAC 地址。

-   如果驱动程序正在发送 TCP 或 UDP 帧，则 \_ 与网络缓冲区列表结构关联的所有网络缓冲区结构 \_ 都 \_ 必须与相同的 TCP 或 UDP 连接关联。
    **注意**  根据以下要求，可以拆分传输的以太网帧。 也就是说，多个内存描述符列表 (MDLs) 可以与 \_ 发送请求中的网络缓冲区结构相关联。

     

-   不要跨多个 MDLs 拆分传输以太网帧的 MAC 标头。 将虚拟 LAN (VLAN)  (或优先级) 标志（如果存在）视为 MAC 标头的一部分。 因此，此标志必须与 MAC 标头的其余部分位于同一 MDL。

-   如果驱动程序更改网络缓冲区结构中的 MDL 链中的链接或网络缓冲区 \_ 列表结构中的网络 \_ 缓冲区 \_ 链 \_ ，则驱动程序必须在将网络缓冲区列表的所有权返回 \_ \_ 到过量驱动程序之前，将链接还原为原始配置。 但是，驱动程序不需要还原网络 \_ 缓冲区列表结构之间的链接 \_ 。

 

